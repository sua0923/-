import streamlit as st

# --- ì •ë‹µ ì„¤ì • ---
# ë¹ˆì¹¸ ì±„ìš°ê¸° ì •ë‹µ (ëŒ€ì†Œë¬¸ì êµ¬ë¶„ ì—†ì´ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ì†Œë¬¸ìë¡œ ì €ì¥)
FILL_IN_THE_BLANK_ANSWERS = {
    'A': 'ë¶„ìˆ˜ì‹',
    'B': 'ë‹¤í•­ì‹',
    'C': 'ìœ ë¦¬ì‹',
    'D': 'ë¶„ëª¨ì˜ ê°’'
}

# O/X í€´ì¦ˆ ì •ë‹µ
OX_QUIZ_ANSWERS = {
    1: 'O',
    2: 'X',
    3: 'O'
}

# ë³µì‚¬ ê°€ëŠ¥í•œ ì›ë³¸ í…ìŠ¤íŠ¸ ë‚´ìš©
CONCEPT_TEXT_FOR_COPY = """
# ê³ ë“± ìˆ˜í•™: I. ìœ ë¦¬ì‹ê³¼ ë¬´ë¦¬ì‹ - ìœ ë¦¬ì‹ì˜ ê°œë…

## 1. ìœ ë¦¬ì‹ì´ë€ ë¬´ì—‡ì¼ê¹Œìš”?

ìš°ë¦¬ëŠ” ì´ë¯¸ ìˆ«ìë¡œ ì´ë£¨ì–´ì§„ ë¶„ìˆ˜ $\left( \frac{1}{2}, \frac{3}{5} \right)$ì— ëŒ€í•´ ì˜ ì•Œê³  ìˆìŠµë‹ˆë‹¤. ìœ ë¦¬ì‹ì€ ì´ëŸ¬í•œ ë¶„ìˆ˜ì˜ ê°œë…ì„ **'ë¬¸ìë¡œ ì´ë£¨ì–´ì§„ ì‹'**ìœ¼ë¡œ í™•ì¥í•œ ê²ƒì…ë‹ˆë‹¤.

**ë‹¤í•­ì‹**ì´ë€ $x^2 + 3x - 1$ ë˜ëŠ” $5y$ì²˜ëŸ¼ ë¬¸ìì™€ ìˆ«ìì˜ ê³±ìœ¼ë¡œ ì´ë£¨ì–´ì§„ í•­ë“¤ì˜ í•©ìœ¼ë¡œë§Œ í‘œí˜„ëœ ì‹ì„ ë§í•©ë‹ˆë‹¤.

ìœ ë¦¬ì‹ì€ ì´ ë‹¤í•­ì‹ì„ ì‚¬ìš©í•˜ì—¬ ë¶„ìˆ˜ í˜•íƒœë¡œ ë‚˜íƒ€ë‚´ëŠ” ì‹ì„ ì˜ë¯¸í•˜ë©°, í¬ê²Œ ë‘ ê°€ì§€ ì¢…ë¥˜ë¡œ ë‚˜ë‰©ë‹ˆë‹¤.

---

### í•µì‹¬ ê°œë… ì •ë¦¬ (ë¹ˆì¹¸ ì±„ìš°ê¸°)

1.  **ë¶„ìˆ˜ì‹:**
    ë‘ ë‹¤í•­ì‹ $A$ì™€ $B$ ($B \neq 0$)ì— ëŒ€í•˜ì—¬, $\frac{A}{B}$ ê¼´ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆëŠ” ì‹ ì¤‘ **ë‹¤í•­ì‹ì´ ì•„ë‹Œ ì‹**ì„ **( A )** ì´ë¼ê³  í•©ë‹ˆë‹¤. (ì˜ˆ: $\frac{1}{x}, \frac{x-1}{x^2+1}$)

2.  **ìœ ë¦¬ì‹ì˜ ë¶„ë¥˜:**
    ìœ„ì—ì„œ ì •ì˜í•œ **( A )** ì™€ $A, B$ë¥¼ ë‹¤í•­ì‹ì´ë¼ í•  ë•Œ, $B$ê°€ $A$ì˜ ì•½ìˆ˜ê°€ ë˜ì–´ ë¶„ìˆ˜ í˜•íƒœê°€ ì‚¬ë¼ì§€ëŠ” ì‹(ì˜ˆ: $x+3$)ì¸ **( B )** ì„ í†µí‹€ì–´ **( C )** ì´ë¼ê³  ë¶€ë¦…ë‹ˆë‹¤.

3.  **ì‹ì˜ ì„±ë¦½ ì¡°ê±´:**
    ìœ ë¦¬ì‹ì˜ ê°’ì´ ìˆ˜í•™ì ìœ¼ë¡œ ì˜ë¯¸ë¥¼ ê°–ê¸° ìœ„í•´ì„œëŠ”, ë¶„ëª¨ì— ë¬¸ìê°€ í¬í•¨ë˜ì–´ ìˆì„ ë•Œ ê·¸ **( D )** ì´ í•­ìƒ **0ì´ ì•„ë‹ˆì–´ì•¼** í•©ë‹ˆë‹¤.

---

## 2. O/X í€´ì¦ˆ (ê°œë… í™•ì¸)

ë‹¤ìŒ ë¬¸ì¥ì´ ì˜³ìœ¼ë©´ **O**, í‹€ë¦¬ë©´ **X**ë¥¼ ë¹ˆì¹¸ì— ì±„ìš°ì„¸ìš”.

1.  ë‹¤í•­ì‹ $3x^2 - 2x + 5$ëŠ” ìœ ë¦¬ì‹ì´ë‹¤. ( )
2.  ìœ ë¦¬ì‹ $\frac{x+1}{x-2}$ì—ì„œ $x=2$ì¼ ë•Œì˜ ì‹ì˜ ê°’ì€ $3$ì´ë‹¤. ( )
3.  $\frac{x}{y} + \frac{y}{x}$ëŠ” ìœ ë¦¬ì‹ì´ë‹¤. (ë‹¨, $x \neq 0, y \neq 0$) ( )
"""


def check_fill_in_the_blank_answers(answers):
    """ë¹ˆì¹¸ ì±„ìš°ê¸° ì •ë‹µì„ í™•ì¸í•˜ê³  ê²°ê³¼ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤."""
    results = {}
    is_all_correct = True
    for key, correct_answer in FILL_IN_THE_BLANK_ANSWERS.items():
        user_answer = answers.get(key, '').strip().lower().replace(" ", "")
        correct_check = correct_answer.lower().replace(" ", "")
        
        if user_answer == correct_check:
            results[key] = (True, f"âœ… ì •ë‹µ: {correct_answer}")
        else:
            results[key] = (False, f"âŒ ì˜¤ë‹µ. ì •ë‹µì€ {correct_answer}ì…ë‹ˆë‹¤.")
            is_all_correct = False
    return results, is_all_correct

def check_ox_quiz_answers(answers):
    """O/X í€´ì¦ˆ ì •ë‹µì„ í™•ì¸í•˜ê³  ê²°ê³¼ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤."""
    results = {}
    is_all_correct = True
    for key, correct_answer in OX_QUIZ_ANSWERS.items():
        user_answer = answers.get(key)
        
        # ì‚¬ìš©ìê°€ ì•„ë¬´ê²ƒë„ ì„ íƒí•˜ì§€ ì•Šì€ ê²½ìš°ë¥¼ ì²˜ë¦¬
        if user_answer is None:
            results[key] = (False, "â“ ë‹µì„ ì„ íƒí•´ì£¼ì„¸ìš”.")
            is_all_correct = False
        elif user_answer == correct_answer:
            results[key] = (True, f"âœ… ì •ë‹µì…ë‹ˆë‹¤.")
        else:
            results[key] = (False, f"âŒ ì˜¤ë‹µì…ë‹ˆë‹¤. ì •ë‹µì€ {correct_answer}ì…ë‹ˆë‹¤.")
            is_all_correct = False
    return results, is_all_correct

# --- Streamlit ì•± ë³¸ë¬¸ ---
st.set_page_config(layout="centered", page_title="ìœ ë¦¬ì‹ ê°œë… í•™ìŠµ")
st.title("ğŸ“š ê³ ë“± ìˆ˜í•™: ìœ ë¦¬ì‹ ê°œë… ë° í€´ì¦ˆ")
st.markdown("---")

# 1. ìœ ë¦¬ì‹ ê°œë… ì„¤ëª…
st.header("1. ìœ ë¦¬ì‹ì´ë€ ë¬´ì—‡ì¼ê¹Œìš”?")
st.markdown("""
ìš°ë¦¬ëŠ” ì´ë¯¸ ìˆ«ìë¡œ ì´ë£¨ì–´ì§„ ë¶„ìˆ˜ $\left( \frac{1}{2}, \frac{3}{5} \right)$ì— ëŒ€í•´ ì˜ ì•Œê³  ìˆìŠµë‹ˆë‹¤. 
ìœ ë¦¬ì‹ì€ ì´ëŸ¬í•œ ë¶„ìˆ˜ì˜ ê°œë…ì„ **'ë¬¸ìë¡œ ì´ë£¨ì–´ì§„ ì‹'**ìœ¼ë¡œ í™•ì¥í•œ ê²ƒì…ë‹ˆë‹¤.

**ë‹¤í•­ì‹**ì´ë€ $x^2 + 3x - 1$ ë˜ëŠ” $5y$ì²˜ëŸ¼ ë¬¸ìì™€ ìˆ«ìì˜ ê³±ìœ¼ë¡œ ì´ë£¨ì–´ì§„ í•­ë“¤ì˜ í•©ìœ¼ë¡œë§Œ í‘œí˜„ëœ ì‹ì„ ë§í•©ë‹ˆë‹¤.

ìœ ë¦¬ì‹ì€ ì´ ë‹¤í•­ì‹ì„ ì‚¬ìš©í•˜ì—¬ ë¶„ìˆ˜ í˜•íƒœë¡œ ë‚˜íƒ€ë‚´ëŠ” ì‹ì„ ì˜ë¯¸í•˜ë©°, í¬ê²Œ ë‘ ê°€ì§€ ì¢…ë¥˜ë¡œ ë‚˜ë‰©ë‹ˆë‹¤.
""")

st.markdown("---")

# 2. í•µì‹¬ ê°œë… ì •ë¦¬ (ë¹ˆì¹¸ ì±„ìš°ê¸°)
st.subheader("ğŸ“ í•µì‹¬ ê°œë… ì •ë¦¬ (ë¹ˆì¹¸ ì±„ìš°ê¸°)")

# --- ë¹ˆì¹¸ ì±„ìš°ê¸° í¼ ---
with st.form("fill_in_the_blank_form"):
    st.markdown("""
    1.  **ë¶„ìˆ˜ì‹:**
        ë‘ ë‹¤í•­ì‹ $A$ì™€ $B$ ($B \neq 0$)ì— ëŒ€í•˜ì—¬, $\frac{A}{B}$ ê¼´ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆëŠ” ì‹ ì¤‘ **ë‹¤í•­ì‹ì´ ì•„ë‹Œ ì‹**ì„ **( A )** ì´ë¼ê³  í•©ë‹ˆë‹¤. (ì˜ˆ: $\frac{1}{x}, \frac{x-1}{x^2+1}$)
    """)
    ans_a = st.text_input("ë¹ˆì¹¸ ( A )", key='input_a')
    
    st.markdown("""
    2.  **ìœ ë¦¬ì‹ì˜ ë¶„ë¥˜:**
        ìœ„ì—ì„œ ì •ì˜í•œ **( A )** ì™€ $A, B$ë¥¼ ë‹¤í•­ì‹ì´ë¼ í•  ë•Œ, $B$ê°€ $A$ì˜ ì•½ìˆ˜ê°€ ë˜ì–´ ë¶„ìˆ˜ í˜•íƒœê°€ ì‚¬ë¼ì§€ëŠ” ì‹(ì˜ˆ: $x+3$)ì¸ **( B )** ì„ í†µí‹€ì–´ **( C )** ì´ë¼ê³  ë¶€ë¦…ë‹ˆë‹¤.
    """)
    col1, col2 = st.columns(2)
    with col1:
        ans_b = st.text_input("ë¹ˆì¹¸ ( B )", key='input_b')
    with col2:
        ans_c = st.text_input("ë¹ˆì¹¸ ( C )", key='input_c')
    
    st.markdown("""
    3.  **ì‹ì˜ ì„±ë¦½ ì¡°ê±´:**
        ìœ ë¦¬ì‹ì˜ ê°’ì´ ìˆ˜í•™ì ìœ¼ë¡œ ì˜ë¯¸ë¥¼ ê°–ê¸° ìœ„í•´ì„œëŠ”, ë¶„ëª¨ì— ë¬¸ìê°€ í¬í•¨ë˜ì–´ ìˆì„ ë•Œ ê·¸ **( D )** ì´ í•­ìƒ **0ì´ ì•„ë‹ˆì–´ì•¼** í•©ë‹ˆë‹¤.
    """)
    ans_d = st.text_input("ë¹ˆì¹¸ ( D )", key='input_d')
    
    submitted_fill = st.form_submit_button("ë¹ˆì¹¸ ì •ë‹µ í™•ì¸í•˜ê¸°")

if submitted_fill:
    user_answers = {'A': ans_a, 'B': ans_b, 'C': ans_c, 'D': ans_d}
    results, all_correct = check_fill_in_the_blank_answers(user_answers)
    
    st.markdown("---")
    st.subheader("ë¹ˆì¹¸ ì±„ìš°ê¸° ê²°ê³¼")
    
    # ê²°ê³¼ ì¶œë ¥
    st.write(f"**( A )**: {results['A'][1]}")
    st.write(f"**( B )**: {results['B'][1]}")
    st.write(f"**( C )**: {results['C'][1]}")
    st.write(f"**( D )**: {results['D'][1]}")

    if all_correct:
        st.balloons()
        st.success("ğŸ‰ ëª¨ë“  ë¹ˆì¹¸ì„ ì™„ë²½í•˜ê²Œ ì±„ìš°ì…¨ìŠµë‹ˆë‹¤! ìœ ë¦¬ì‹ ê°œë…ì„ ì •í™•íˆ ì´í•´í–ˆë„¤ìš”.")
    else:
        st.error("ì•„ì§ í—·ê°ˆë¦¬ëŠ” ë¶€ë¶„ì´ ìˆì–´ìš”. ë‹¤ì‹œ í•œë²ˆ ê°œë…ì„ ë³µìŠµí•´ ë³´ì„¸ìš”!")

st.markdown("---")

# 3. O/X í€´ì¦ˆ (ê°œë… í™•ì¸)
st.subheader("ğŸ¯ O/X í€´ì¦ˆ (ê°œë… í™•ì¸)")

# --- O/X í€´ì¦ˆ í¼ ---
with st.form("ox_quiz_form"):
    st.markdown("""
    ë‹¤ìŒ ë¬¸ì¥ì´ ì˜³ìœ¼ë©´ **O**, í‹€ë¦¬ë©´ **X**ë¥¼ ì„ íƒí•˜ì„¸ìš”.
    """)
    
    ox1 = st.radio(
        "1. ë‹¤í•­ì‹ $3x^2 - 2x + 5$ëŠ” ìœ ë¦¬ì‹ì´ë‹¤.", 
        ('O', 'X'), 
        key='ox_q1', 
        index=None
    )
    
    # st.latexë¥¼ ì‚¬ìš©í•˜ì—¬ ë¶„ëª¨ê°€ 0ì´ ë˜ëŠ” ì¡°ê±´ ê°•ì¡°
    ox2 = st.radio(
        "2. ìœ ë¦¬ì‹ $\\frac{x+1}{x-2}$ì—ì„œ $x=2$ì¼ ë•Œì˜ ì‹ì˜ ê°’ì€ $3$ì´ë‹¤.", 
        ('O', 'X'), 
        key='ox_q2', 
        index=None
    )
    
    ox3 = st.radio(
        "3. $\\frac{x}{y} + \\frac{y}{x}$ëŠ” ìœ ë¦¬ì‹ì´ë‹¤. (ë‹¨, $x \\neq 0, y \\neq 0$)", 
        ('O', 'X'), 
        key='ox_q3', 
        index=None
    )
    
    submitted_ox = st.form_submit_button("O/X ì •ë‹µ í™•ì¸í•˜ê¸°")

if submitted_ox:
    user_answers = {1: ox1, 2: ox2, 3: ox3}
    results, all_correct = check_ox_quiz_answers(user_answers)
    
    st.markdown("---")
    st.subheader("O/X í€´ì¦ˆ ê²°ê³¼")
    
    # ê²°ê³¼ ì¶œë ¥ ë° í•´ì„¤ ì¶”ê°€
    st.write(f"**1. ë‹¤í•­ì‹ì€ ìœ ë¦¬ì‹ì´ë‹¤.** {results[1][1]}")
    st.caption("âœ… í•´ì„¤: ë‹¤í•­ì‹ì€ ë¶„ëª¨ê°€ 1ì¸ ë¶„ìˆ˜ì‹ìœ¼ë¡œ ìƒê°í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ìœ ë¦¬ì‹ì— í¬í•¨ë©ë‹ˆë‹¤.")

    st.write(f"**2. $x=2$ì¼ ë•Œ $\\frac{x+1}{x-2}$ì˜ ê°’ì€ $3$ì´ë‹¤.** {results[2][1]}")
    st.caption("âŒ í•´ì„¤: $x=2$ë¥¼ ëŒ€ì…í•˜ë©´ ë¶„ëª¨ê°€ $2-2=0$ì´ ë˜ë¯€ë¡œ, ì‹ì˜ ê°’ì´ **ì •ì˜ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.**")
    
    st.write(f"**3. $\\frac{x}{y} + \\frac{y}{x}$ëŠ” ìœ ë¦¬ì‹ì´ë‹¤.** {results[3][1]}")
    st.caption("âœ… í•´ì„¤: ë‘ ë‹¤í•­ì‹ì˜ ë¹„ë¡œ ë‚˜íƒ€ë‚¸ ë¶„ìˆ˜ì‹ì˜ í•© ë˜ëŠ” ì°¨ëŠ” ë‹¤ì‹œ ìœ ë¦¬ì‹ì´ ë©ë‹ˆë‹¤.")
    
    if all_correct:
        st.success("ğŸ’¯ O/X í€´ì¦ˆë„ ëª¨ë‘ ë§í˜”ìŠµë‹ˆë‹¤! ì™„ë²½í•´ìš”!")
    else:
        st.warning("ì¼ë¶€ ì˜¤ë‹µì´ ìˆìŠµë‹ˆë‹¤. í•´ì„¤ì„ í†µí•´ í‹€ë¦° ë¶€ë¶„ì„ í™•ì¸í•˜ê³  ë„˜ì–´ê°€ì„¸ìš”.")

st.markdown("---")
st.markdown("##### ğŸ’¡ ì¶”ê°€ í•™ìŠµ: ìœ ë¦¬ì‹ì€ ë¶„ìˆ˜ì™€ ë§ˆì°¬ê°€ì§€ë¡œ ì•½ë¶„í•˜ê±°ë‚˜ í†µë¶„í•˜ì—¬ ë”í•˜ê±°ë‚˜ ëº„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒì—ëŠ” ìœ ë¦¬ì‹ì˜ ì‚¬ì¹™ì—°ì‚°ì„ í•™ìŠµí•´ ë´…ì‹œë‹¤.")

# 4. ë³µì‚¬ ë¶™ì—¬ë„£ê¸°ë¥¼ ìœ„í•œ ì›ë³¸ í…ìŠ¤íŠ¸ ì„¹ì…˜ ì¶”ê°€
st.markdown("---")
st.subheader("ğŸ“‹ ì›ë³¸ êµê³¼ì„œ ë‚´ìš© ë³µì‚¬í•˜ê¸°")
st.info("ì•„ë˜ ì½”ë“œë¥¼ ë³µì‚¬í•˜ì—¬ ë¬¸ì„œ í¸ì§‘ê¸°ì— ë¶™ì—¬ë„£ìœ¼ì‹œë©´ ë©ë‹ˆë‹¤.")
st.code(CONCEPT_TEXT_FOR_COPY, language='markdown')
